upstream myserver {
    server monkeygamestore:8015;
}

server {
    # SSL configuration
    listen 8080 ssl http2;
    listen [::]:8080 ssl http2;
    ssl_certificate         /etc/ssl/cert.pem;
    ssl_certificate_key     /etc/ssl/key.pem;
    ssl_client_certificate /etc/ssl/cloudflare.crt;
    ssl_verify_client on; 
    server_name monkeygamestore.online;   
    location = /favicon.ico { access_log off ; 
    log_not_found off; 
    }

    location /static/ {
        root /home;
    }
    location /media/ {
        root /home;
    }

    location / {	
	proxy_pass https://myserver;
	proxy_ssl_server_name on;
	proxy_set_header X-Forwarded-Host $host;
	proxy_set_header X-Forwarded-Server $host;
	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	proxy_ssl_name monkeygamestore.online;
        proxy_set_header Host $http_host;
	proxy_ssl_certificate /etc/ssl/cert.pem;
	proxy_ssl_certificate_key /etc/ssl/key.pem;
    }
}
