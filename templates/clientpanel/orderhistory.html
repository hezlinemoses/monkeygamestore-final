{% extends 'clientpanel/account_base.html' %}
{% load static %}
{% block dynamic_css %} <link rel="stylesheet" href="{% static 'styles/clientpanel/orderhistory.css' %}"> {% endblock dynamic_css %}
{% block dynamic %}
{% if messages %}

                    {% for message in messages %}
                        
                          <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
                          <script>
                            Swal.fire({
                              icon: 'success',
                              
                              text: "{{message}}",
                            })
                          </script>
                        
                    {% endfor %}
                    {% endif %}


    <div class="table-responsive mb-5" style='width:100%;'>
    <table class="table table-striped table-dark" style='width:90%;'>
      <thead>
        <tr>
          <th scope="col">Order no.</th>
          <th scope="col">Created on</th>
          <th scope="col">No.of Items</th>
          <th scope="col">Status</th>
          <th scope="col">Total Amount</th>
          <th scope="col">Options</th>
        </tr>
      </thead>
      <tbody>
        

        {% if processingorders %}
        {% for order in processingorders %}
        <tr>
          <th scope="row"><a href="{% url 'orderdetail' order.id %}">{{order.id}}</a></th>
          <td>{{order.created_at}} </td>
          <td>{{order.itemcount}}</td>
          <td>
              {% if order.status == 'Completed' %}
                <span class='text-success'>{{order.status}}</span>
              {% elif order.status == 'Cancelled' %}
                <span class='text-danger'>{{order.status}}</span>
              {% else %}
              <span class='text-warning'>{{order.status}}</span>
              {% endif %}
          </td>
          <td>{{order.total}}</td>
          {% comment %} {% if order.status == 'Pending Payment' %}
          <td><a href="{% url 'ordercancel' order.id %}"><i class="fas fa-trash fa-lg text-danger" onclick="return confirm('Are you sure to cancel this order ?')"></i></a></td> {% endcomment %}
          {% if order.status == 'Processing' %}
          <td><a href="{% url 'ordercancel' order.id %}"><i class="fas fa-trash fa-lg text-danger" onclick="return confirm('Are you sure to cancel this order ?')"></i></a></td>
          {% endif %}
        </tr>
        {% endfor %}
        {% endif %}

        {% if completedorders %}
        {% for order in completedorders %}
        <tr>
          <th scope="row"><a href="{% url 'orderdetail' order.id %}">{{order.id}}</a></th>
          <td>{{order.created_at}}</td>
          <td>{{order.itemcount}}</td>
          <td>
            <span class='text-success'>{{order.status}}</span>
          </td>
          <td>{{order.total}}</td>
          <td>{% if order.is_refundable %}
            <a href="{% url 'requestrefund' order.id %}"><button class="btn btn-sm btn-outline-warning" onclick="return confirm('You wont be able to use the product keys once refunded,are you sure you want to continue?');">Request Refund</button></a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
        {% endif %}
      </tbody>
    </table>
    </div>
  

{% endblock dynamic %}